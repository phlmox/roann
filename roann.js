function randomstr(e){for(var r="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;t<e;t++)r+=a.charAt(Math.floor(62*Math.random()));return r}function payloadManager(e,r,a,t){var n="";if(0==queryString.length)return n=r[0]+"="+a,t&&(n+=randomstr(6)),n;for(j=0;j<e.length;j++){var o=e[j].split("=");o[0]==r[0]?(n+=o[0]+"="+a,t&&(n+=randomstr(6))):n+=o[0]+"="+o[1],j!=e.length-1&&(n+="&")}return n}function payloadManagerPOST(e,r,a){var t="";for(j=0;j<e.length;j++)""!=e[j].name&&(e[j].name==r?t+=encodeURI(e[j].name)+"="+a+randomstr(6):(pval=""!=e[j].value?e[j].value:"rNnTRbt=1 x=d'\"><div rNnTRbt='1'>"+randomstr(6),t+=encodeURI(e[j].name)+"="+pval),j!=e.length-1&&(t+="&"));return"&"==t.slice(-1)&&(t=t.slice(0,-1)),t}function updateBadge(){chrome.runtime.sendMessage({reqc:"badge:"+req.toString()}).then(_,_)}function paramboxCheck(e){if("roanNPaRaM"==e||!parambox_check||parambox_dump.includes(e))return!1;parambox_dump.push(e)}function testPayload(e,r,a,t){paramboxCheck(a),!(req>=max_req)&&(req+=1,updateBadge(),2==t&&(r=r.replace("rNnTRbt","rNnTRbtCAN")),(xhr=new XMLHttpRequest).onload=function(){if(parser=new DOMParser,null!=this.responseXML){for(i=0,doc=parser.parseFromString(this.responseXML.body.parentElement.innerHTML,"text/html");i<sqli_msg.length;i++)doc.body.parentElement.innerHTML.includes(sqli_msg[i])&&(document.title="[RoanN]",addIssue(e+"?"+encodeURI(r).replace("%3Cdiv%20rNnTRbt=roann%3E","{escape}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{escape}").replace("'%22%20rNnTRbt=%22roannATTR%22","{escape}"),"SQLi"),location.hash.includes("RNBulk")||alert(alertTxt="𝗚𝗼𝗼𝗱 𝗡𝗲𝘄𝘀, 𝐏𝐨𝐬𝐬𝐢𝐛𝐥𝐞 𝐒𝐐𝐋𝐈 𝗙𝗼𝘂𝗻𝗱! on "+e+"?"+encodeURI(r).replace("%3Cdiv%20rNnTRbt=roann%3E","{escape}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{escape}").replace("'%22%20rNnTRbt=%22roannATTR%22","{escape}")+" 𝐄𝐫𝐫𝐨𝐫 𝐌𝐞𝐬𝐬𝐚𝐠𝐞 -> "+sqli_msg[i]+" ("+a+")"));var n;n=2==t?"[rNnTRbtCAN]":r.indexOf("roannATTR")>-1?"[rNnTRbt]":"div[rNnTRbt]",doc.querySelectorAll(n).length>0&&(document.title="[RoanN]",alertTxt="𝗚𝗼𝗼𝗱 𝗡𝗲𝘄𝘀, 𝐆𝐞𝐭 𝐛𝐚𝐬𝐞𝐝 𝗫𝗦𝗦 𝗙𝗼𝘂𝗻𝗱! on "+e+"?"+(payldClear=(payldClear=encodeURI(r).replace("%3Cdiv%20rNnTRbt=roann%3E","{payload}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{payload}").replace("'%22%20rNnTRbt=%22roannATTR%22","{𝗮𝘁𝘁𝗿𝗶𝗯𝘂𝘁𝗲}={payload}")).replace("<div rNnTRbt=roann>","{payload}")),1==t?alertTxt+="  (𝐇𝐞𝐮𝐫𝐢𝐬𝐭𝐢𝐜 𝐒𝐜𝐚𝐧)":2==t&&(alertTxt+="  (𝐂𝐚𝐧𝐨𝐧𝐢𝐜𝐚𝐥)"),addIssue(e+"?"+payldClear,"XSS"),alertTxt+=" ("+a+")",location.hash.includes("RNBulk")||alert(alertTxt))}},xhr.open("GET",e+"?"+r),xhr.responseType="document",xhr.send())}function testPathPayload(e,r){for(i=0;i<unwanted_path.length;i++)if(e.split("#")[0].split("?")[0].toLowerCase().endsWith(unwanted_path[i]))return;e.endsWith("/")&&(e=e.slice(0,-1)),req>=max_req||(req+=1,updateBadge(),url=e.split("#")[0].split("?")[0].split("/").slice(0,-1).join("/"),(xhr=new XMLHttpRequest).onload=function(){if(null!=this.responseXML){for(doc=(parser=new DOMParser).parseFromString(this.responseXML.body.parentElement.innerHTML,"text/html"),i=0;i<sqli_msg.length;i++)doc.body.parentElement.innerHTML.includes(sqli_msg[i])&&(alertTxt="𝗚𝗼𝗼𝗱 𝗡𝗲𝘄𝘀, 𝐏𝐨𝐬𝐬𝐢𝐛𝐥𝐞 𝐒𝐐𝐋𝐈 𝗙𝗼𝘂𝗻𝗱! on "+url+"/"+encodeURI(r).replace("%3Cdiv%20rNnTRbt=roann%3E","{escape}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{escape}").replace("'%22%20rNnTRbt=%22roannATTR%22","{escape}")+" 𝐄𝐫𝐫𝐨𝐫 𝐌𝐞𝐬𝐬𝐚𝐠𝐞 -> "+sqli_msg[i],document.title="[RoanN]",addIssue(url+"/"+encodeURI(r),"SQLi"),alert(alertTxt));var e;e=r.indexOf("roannATTR")>-1?"[rNnTRbt]":"div[rNnTRbt]",doc.querySelectorAll(e).length>0&&(alertTxt="𝗚𝗼𝗼𝗱 𝗡𝗲𝘄𝘀, 𝐏𝐚𝐭𝐡 𝐛𝐚𝐬𝐞𝐝 𝗫𝗦𝗦 𝗙𝗼𝘂𝗻𝗱! on "+url.split("/").slice(0,-1).join("/")+"/"+encodeURI(r).replace("%3Cdiv%20rNnTRbt=roann%3E","{payload}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{payload}").replace("'%22%20rNnTRbt=%22roannATTR%22","{𝗮𝘁𝘁𝗿𝗶𝗯𝘂𝘁𝗲}={payload}"),document.title="[RoanN]",addIssue(url+"/"+encodeURI(r),"XSS"),location.hash.includes("RNBulk")||alert(alertTxt))}},xhr.open("GET",url+"/"+encodeURI(r)),xhr.responseType="document",xhr.send())}function testPOSTPayload(e,r,a,t,n){paramboxCheck(t),!(req>=max_req)&&(req+=1,updateBadge(),$.ajax({type:a,url:e,data:r,success:function(n){if(parser=new DOMParser,null!=n){for(i=0,doc=parser.parseFromString(n,"text/html");i<sqli_msg.length;i++)doc.body.parentElement.innerHTML.includes(sqli_msg[i])&&(document.title="[RoanN]",addIssue(location.href+" - "+e,"SQLi"),location.hash.includes("RNBulk")||alert(alertTxt="𝗚𝗼𝗼𝗱 𝗡𝗲𝘄𝘀, 𝐏𝐨𝐬𝐬𝐢𝐛𝐥𝐞 𝐒𝐐𝐋𝐈 𝗙𝗼𝘂𝗻𝗱! on "+e+"?"+encodeURI(r).replace("%3Cdiv%20rNnTRbt=roann%3E","{escape}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{escape}").replace("'%22%20rNnTRbt=%22roannATTR%22","{escape}")+" 𝐄𝐫𝐫𝐨𝐫 𝐌𝐞𝐬𝐬𝐚𝐠𝐞 -> "+sqli_msg[i]+" ("+t+")"));var o;o=r.indexOf("roannATTR")>-1?"[rNnTRbt]":"div[rNnTRbt]",doc.querySelectorAll(o).length>0&&(document.title="[RoanN]",payldClear=(payldClear=r.replace("%3Cdiv%20rNnTRbt=roann%3E","{payload}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{payload}").replace("'%22%20rNnTRbt=%22roannATTR%22","{𝗮𝘁𝘁𝗿𝗶𝗯𝘂𝘁𝗲}={payload}")).replace("<div rNnTRbt=roann>","{payload}").replace('rNnTRbt="roannATTR"',"{𝗮𝘁𝘁𝗿𝗶𝗯𝘂𝘁𝗲}={payload}"),addIssue(location.href+" - "+e,"XSS"),location.hash.includes("RNBulk")||alert("𝗚𝗼𝗼𝗱 𝗡𝗲𝘄𝘀, '"+a.toUpperCase()+"' 𝐛𝐚𝐬𝐞𝐝 𝗫𝗦𝗦 𝗙𝗼𝘂𝗻𝗱! on "+e+" , 𝐃𝐚𝐭𝐚: "+payldClear+" ("+t+")"))}},dataType:"html"}))}function scriptXSS_subtest(e,r,a,t){!(req>=max_req)&&(req+=1,updateBadge(),t?(qry=location.href.split("?")[1],(url=location.href.split("?")[0]).endsWith("/")&&(url=url.slice(0,-1)),url=url.split("/").slice(0,-1).join("/")+"/roannisx"+a+r+"rix?"+qry):(payld=payloadManager(queryString.split("&"),[e,"roannisx"],"roannisx"+a+r+"rix",!1),url=location.href.split("?")[0]+"?"+payld),(xhr=new XMLHttpRequest).onload=function(){parser=new DOMParser,null!=this.responseXML&&[...(doc=parser.parseFromString(this.responseXML.body.parentElement.innerHTML,"text/html")).getElementsByTagName("script")].map((n=>{n.innerText.split("\n").map((n=>{null==(x_match=n.match(r+"(.*)roannisx"+a+a+a+a+r+"rix"))||(document.title="[RoanN]",location.hash.includes("RNBulk")||(alertTxt="𝗚𝗼𝗼𝗱 𝗡𝗲𝘄𝘀, 𝐏𝐨𝐬𝐬𝐢𝐛𝐥𝐞 𝐗𝐒𝐒 𝐢𝐧𝐬𝐢𝐝𝐞 𝐒𝐜𝐫𝐢𝐩𝐭 𝐓𝐚𝐠 𝗙𝗼𝘂𝗻𝗱 on '"+location.href+"' !",alertTxt+=t?"(𝐏𝐚𝐭𝐡 𝐁𝐚𝐬𝐞𝐝)":"("+e+")",alert(alertTxt)))}))}))},xhr.open("GET",url),xhr.responseType="document",xhr.send())}function scriptXSS(e,r){!(req>=max_req)&&(req+=1,updateBadge(),r?(qry=location.href.split("?")[1],(url=location.href.split("?")[0]).endsWith("/")&&(url=url.slice(0,-1)),url=url.split("/").slice(0,-1).join("/")+"/roannisx?"+qry):(payld=payloadManager(queryString.split("&"),[e,"roannisx"],"roannisx",!1),url=location.href.split("?")[0]+"?"+payld),(xhr=new XMLHttpRequest).onload=function(){parser=new DOMParser,null!=this.responseXML&&[...(doc=parser.parseFromString(this.responseXML.body.parentElement.innerHTML,"text/html")).getElementsByTagName("script")].map((a=>{a.innerText.split("\n").map((a=>{a.split(";").map((a=>{null!=(y_match=a.match(/('|")(.*?)roannisx/))&&(scriptXSS_subtest(e,y_match[1],"",r),scriptXSS_subtest(e,y_match[1],"\\",r))}))}))}))},xhr.open("GET",url),xhr.responseType="document",xhr.send())}function addIssue(e,r){chrome.storage.local.get({history:[]},(function(e){var a=e.history;ustr=location.href.length>60?location.href.slice(0,57)+"...":location.href,a.push(['<a target="_blank" href="'+location.href+'">'+ustr+"</a>",r]),chrome.storage.local.set({history:a},(function(){console.log("issue added!")}))}))}function validateCode(e){return!/[^a-zA-Z0-9_]/.test(e)}_=()=>{};var parambox_check=!1;chrome.storage.local.get(["parambox"],(function(e){"on"==e.parambox&&(parambox_check=!0)}));const queryString=window.location.search.substring(1);var payloads=["'\"><div rNnTRbt=roann>","'\"><\/script><div rNnTRbt=roann>",'\'" rNnTRbt="roannATTR" x=y'],parambox_dump=[],sqli_msg=["Microsoft OLE DB Provider for ODBC Drivers error","You have an error in your SQL syntax","SQL command not properly ended","Microsoft SQL Native Client error","Query failed: ERROR: syntax error at or near","You have an error in your SQL syntax","MySQL Error: 1064","mysql error with query","SQL syntax error","PostgreSQL query failed: ERROR: parser: parse error","Warning: mysql_","<b>Warning</b>:  mysql_","Warning: mysqli_","<b>Warning</b>:  mysqli_"],tested_param=[],req=0;max_req=0;const unwanted=[".js",".css",".png",".jpg",".jpeg",".gif",".pdf",".exe",".mp3",".mp4",".wav"],unwanted_path=[".php",".php5",".htm",".html",".asp",".aspx",".jsp",".do"];var advancedMode="";chrome.storage.local.get(["advanced"],(function(e){advancedMode=e.advanced})),(clear_href=location.href.split("#")[0].split("?")[0]).endsWith("/")&&(clear_href=clear_href.slice(0,-1)),chrome.storage.local.get(["maxreq"],(function(e){max_req=parseInt(e.maxreq)})),document.querySelectorAll("[rNnTRbt]").length>0&&alert("𝗚𝗼𝗼𝗱 𝗡𝗲𝘄𝘀, 𝐏𝐨𝐬𝐬𝐢𝐛𝐥𝐞 𝐒𝐭𝐨𝐫𝐞𝐝 𝗫𝗦𝗦 𝗙𝗼𝘂𝗻𝗱!"),chrome.storage.local.get(["roann"],(function(e){if("on"==e.roann){for(i=0;i<unwanted.length;i++)if(location.href.split("#")[0].split("?")[0].toLowerCase().endsWith(unwanted[i]))return;chrome.storage.local.get({blacklist:[]},(function(e){for(bi=0;bi<e.blacklist.length;bi++)if(-1!==window.location.hostname.indexOf(e.blacklist[bi]))return;for(p=0;p<payloads.length;p++)testPayload(window.location.href.split("?")[0],"roaNNPaRaM="+payloads[p],"roanNPaRaM",2);if(queryString.length>0){var a=queryString.split("&");for(i=0,url=window.location.href.split("?")[0];i<a.length;i++)if(!tested_param.includes(a[i].split("=")[0])){for(scriptXSS(a[i].split("=")[0],!1),val=a[i].split("="),p=0;p<payloads.length;p++)url=window.location.href.split("?")[0],testPayload(url,payl=payloadManager(a,val,payloads[p],!0),val[0],0);tested_param.push(payl.split("=")[0])}}if(keyword=clear_href.split("/").slice(-1)[0],document.body.parentElement.innerHTML.includes(keyword)&&""!=keyword&&location.hostname!=keyword)for(scriptXSS(null,!0),p=0;p<payloads.length;p++)testPathPayload(clear_href,payloads[p]);chrome.storage.local.get(["onlyget"],(function(e){if("off"==e.onlyget){for(r=0,formsCollection=document.forms;r<formsCollection.length;r++)for(i=0,inputs=formsCollection[r].elements;i<inputs.length;i++)if(!tested_param.includes(inputs[i].name)&&""!=inputs[i].name){for(scriptXSS(iname=inputs[i].name,!1),p=0;p<payloads.length;p++)payl=payloadManagerPOST(inputs,iname,payloads[p],!0),null!=formsCollection[r].getAttribute("action")?testPOSTPayload(formsCollection[r].getAttribute("action"),payl,formsCollection[r].method,iname,0):"string"==typeof formsCollection[r].action&&testPOSTPayload(formsCollection[r].action,payl,formsCollection[r].method,iname,0);tested_param.push(iname)}for(inputs=document.getElementsByTagName("input"),heuristic=[],i=0;i<inputs.length;i++)heuristic.push(inputs[i].name+"=FUZZ");for(i=0,url=window.location.href.split("?")[0],heuristic=heuristic.filter((function(e){return"=FUZZ"!=e}));i<heuristic.length;i++)if(!tested_param.includes(heuristic[i].split("=")[0])){for(scriptXSS(heuristic[i].split("=")[0],!1),p=0;p<payloads.length;p++)testPayload(url,payl=payloadManager(heuristic,heuristic[i].split("="),payloads[p],!0),heuristic[i].split("=")[0],1);tested_param.push(payl.split("=")[0])}if(document.documentElement.innerHTML.includes("Undefined index"))for(let r of e=document.documentElement.innerHTML.matchAll(/Undefined index: (.*) in/g))if(!tested_param.includes(r[1])){for(scriptXSS(r[1],!1),p=0;p<payloads.length;p++)testPayload(window.location.href.split("?")[0],r[1]+"="+payloads[p],r[1],1);tested_param.push(r[1])}if("on"==advancedMode){for(let e of v_items=document.documentElement.innerHTML.matchAll(/var ([a-zA-Z0-9_]{1,})\s*=/g))if(!tested_param.includes(e[1])){for(scriptXSS(e[1],!1),p=0;p<payloads.length;p++)validateCode(e[1])&&testPayload(window.location.href.split("?")[0],e[1]+"="+payloads[p],e[1],1);tested_param.push(e[1])}for(let r of e=document.body.parentElement.innerHTML.matchAll(/URLSearchParams\((.*)\)\.get\(([^)]+)\)/g))if(!tested_param.includes(r[2].slice(1,-1)))for(scriptXSS(r[2].slice(1,-1),!1),p=0;p<payloads.length;p++)testPayload(window.location.href.split("?")[0],r[2].slice(1,-1)+"="+payloads[p],r[2].slice(1,-1),1)}}})),chrome.storage.local.get({param_box:[]},(function(e){var r=e.param_box;r=r.concat(parambox_dump),r=[...new Set(r)],chrome.storage.local.set({param_box:r},null)}))}))}}));
