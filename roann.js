function randomstr(e){for(var n="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=a.length,o=0;o<e;o++)n+=a.charAt(Math.floor(Math.random()*t));return n}function payloadManager(e,n,a,t){var o="";if(0==queryString.length)return o=n[0]+"="+a,t&&(o+=randomstr(6)),o;for(j=0;j<e.length;j++){var l=e[j].split("=");l[0]==n[0]?(o+=l[0]+"="+a,t&&(o+=randomstr(6))):o+=l[0]+"="+l[1],j!=e.length-1&&(o+="&")}return o}function payloadManagerPOST(e,n,a){var t="";for(j=0;j<e.length;j++)""!=e[j].name&&(e[j].name==n?t+=encodeURI(e[j].name)+"="+a+randomstr(6):(pval=""!=e[j].value?e[j].value:"rNnTRbt=1 x=d'\"><div rNnTRbt='1'>"+randomstr(6),t+=encodeURI(e[j].name)+"="+pval),j!=e.length-1&&(t+="&"));return"&"==t.slice(-1)&&(t=t.slice(0,-1)),t}function updateBadge(){chrome.runtime.sendMessage({reqc:"badge:"+req.toString()}).then(_,_)}function paramboxCheck(e){if("roanNPaRaM"==e||!parambox_check||parambox_dump.includes(e))return!1;parambox_dump.push(e)}function testPayload(e,n,a,t){paramboxCheck(a),!(req>=max_req)&&(req+=1,updateBadge(),2==t&&(n=n.replace("rNnTRbt","rNnTRbtCAN")),(xhr=new XMLHttpRequest).onload=function(){if(parser=new DOMParser,null!=this.responseXML){for(i=0,doc=parser.parseFromString(this.responseXML.body.parentElement.innerHTML,"text/html");i<sqli_msg.length;i++)doc.body.parentElement.innerHTML.includes(sqli_msg[i])&&(document.title="[RoanN]",addIssue(e+"?"+encodeURI(n).replace("%3Cdiv%20rNnTRbt=roann%3E","{escape}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{escape}").replace("'%22%20rNnTRbt=%22roannATTR%22","{escape}"),"SQLi"),location.hash.includes("RNBulk")||alert(alertTxt="\uD835\uDDDA\uD835\uDDFC\uD835\uDDFC\uD835\uDDF1 \uD835\uDDE1\uD835\uDDF2\uD835\uDE04\uD835\uDE00, \uD835\uDC0F\uD835\uDC28\uD835\uDC2C\uD835\uDC2C\uD835\uDC22\uD835\uDC1B\uD835\uDC25\uD835\uDC1E \uD835\uDC12\uD835\uDC10\uD835\uDC0B\uD835\uDC08 \uD835\uDDD9\uD835\uDDFC\uD835\uDE02\uD835\uDDFB\uD835\uDDF1! on "+e+"?"+encodeURI(n).replace("%3Cdiv%20rNnTRbt=roann%3E","{escape}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{escape}").replace("'%22%20rNnTRbt=%22roannATTR%22","{escape}")+" \uD835\uDC04\uD835\uDC2B\uD835\uDC2B\uD835\uDC28\uD835\uDC2B \uD835\uDC0C\uD835\uDC1E\uD835\uDC2C\uD835\uDC2C\uD835\uDC1A\uD835\uDC20\uD835\uDC1E -> "+sqli_msg[i]+" ("+a+")"));var o="";o=2==t?"[rNnTRbtCAN]":n.indexOf("roannATTR")>-1?"[rNnTRbt]":"div[rNnTRbt]",doc.querySelectorAll(o).length>0&&(document.title="[RoanN]",alertTxt="\uD835\uDDDA\uD835\uDDFC\uD835\uDDFC\uD835\uDDF1 \uD835\uDDE1\uD835\uDDF2\uD835\uDE04\uD835\uDE00, \uD835\uDC06\uD835\uDC1E\uD835\uDC2D \uD835\uDC1B\uD835\uDC1A\uD835\uDC2C\uD835\uDC1E\uD835\uDC1D \uD835\uDDEB\uD835\uDDE6\uD835\uDDE6 \uD835\uDDD9\uD835\uDDFC\uD835\uDE02\uD835\uDDFB\uD835\uDDF1! on "+e+"?"+(payldClear=(payldClear=encodeURI(n).replace("%3Cdiv%20rNnTRbt=roann%3E","{payload}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{payload}").replace("'%22%20rNnTRbt=%22roannATTR%22","{\uD835\uDDEE\uD835\uDE01\uD835\uDE01\uD835\uDDFF\uD835\uDDF6\uD835\uDDEF\uD835\uDE02\uD835\uDE01\uD835\uDDF2}={payload}")).replace("<div rNnTRbt=roann>","{payload}")),1==t?alertTxt+="  (\uD835\uDC07\uD835\uDC1E\uD835\uDC2E\uD835\uDC2B\uD835\uDC22\uD835\uDC2C\uD835\uDC2D\uD835\uDC22\uD835\uDC1C \uD835\uDC12\uD835\uDC1C\uD835\uDC1A\uD835\uDC27)":2==t&&(alertTxt+="  (\uD835\uDC02\uD835\uDC1A\uD835\uDC27\uD835\uDC28\uD835\uDC27\uD835\uDC22\uD835\uDC1C\uD835\uDC1A\uD835\uDC25)"),addIssue(e+"?"+payldClear,"XSS"),alertTxt+=" ("+a+")",location.hash.includes("RNBulk")||alert(alertTxt))}},xhr.open("GET",e+"?"+n),xhr.responseType="document",xhr.send())}function testPathPayload(e,n){for(i=0;i<unwanted_path.length;i++)if(e.split("#")[0].split("?")[0].toLowerCase().endsWith(unwanted_path[i]))return;e.endsWith("/")&&(e=e.slice(0,-1)),req>=max_req||(req+=1,updateBadge(),url=e.split("#")[0].split("?")[0].split("/").slice(0,-1).join("/"),(xhr=new XMLHttpRequest).onload=function(){if(null!=this.responseXML){for(doc=(parser=new DOMParser).parseFromString(this.responseXML.body.parentElement.innerHTML,"text/html"),i=0;i<sqli_msg.length;i++)doc.body.parentElement.innerHTML.includes(sqli_msg[i])&&(alertTxt="\uD835\uDDDA\uD835\uDDFC\uD835\uDDFC\uD835\uDDF1 \uD835\uDDE1\uD835\uDDF2\uD835\uDE04\uD835\uDE00, \uD835\uDC0F\uD835\uDC28\uD835\uDC2C\uD835\uDC2C\uD835\uDC22\uD835\uDC1B\uD835\uDC25\uD835\uDC1E \uD835\uDC12\uD835\uDC10\uD835\uDC0B\uD835\uDC08 \uD835\uDDD9\uD835\uDDFC\uD835\uDE02\uD835\uDDFB\uD835\uDDF1! on "+url+"/"+encodeURI(n).replace("%3Cdiv%20rNnTRbt=roann%3E","{escape}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{escape}").replace("'%22%20rNnTRbt=%22roannATTR%22","{escape}")+" \uD835\uDC04\uD835\uDC2B\uD835\uDC2B\uD835\uDC28\uD835\uDC2B \uD835\uDC0C\uD835\uDC1E\uD835\uDC2C\uD835\uDC2C\uD835\uDC1A\uD835\uDC20\uD835\uDC1E -> "+sqli_msg[i],document.title="[RoanN]",addIssue(url+"/"+encodeURI(n),"SQLi"),alert(alertTxt));var e="";e=n.indexOf("roannATTR")>-1?"[rNnTRbt]":"div[rNnTRbt]",doc.querySelectorAll(e).length>0&&(alertTxt="\uD835\uDDDA\uD835\uDDFC\uD835\uDDFC\uD835\uDDF1 \uD835\uDDE1\uD835\uDDF2\uD835\uDE04\uD835\uDE00, \uD835\uDC0F\uD835\uDC1A\uD835\uDC2D\uD835\uDC21 \uD835\uDC1B\uD835\uDC1A\uD835\uDC2C\uD835\uDC1E\uD835\uDC1D \uD835\uDDEB\uD835\uDDE6\uD835\uDDE6 \uD835\uDDD9\uD835\uDDFC\uD835\uDE02\uD835\uDDFB\uD835\uDDF1! on "+url.split("/").slice(0,-1).join("/")+"/"+encodeURI(n).replace("%3Cdiv%20rNnTRbt=roann%3E","{payload}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{payload}").replace("'%22%20rNnTRbt=%22roannATTR%22","{\uD835\uDDEE\uD835\uDE01\uD835\uDE01\uD835\uDDFF\uD835\uDDF6\uD835\uDDEF\uD835\uDE02\uD835\uDE01\uD835\uDDF2}={payload}"),document.title="[RoanN]",addIssue(url+"/"+encodeURI(n),"XSS"),location.hash.includes("RNBulk")||alert(alertTxt))}},xhr.open("GET",url+"/"+encodeURI(n)),xhr.responseType="document",xhr.send())}function testPOSTPayload(e,n,a,t,o){paramboxCheck(t),!(req>=max_req)&&(req+=1,updateBadge(),$.ajax({type:a,url:e,data:n,success:function(o){if(parser=new DOMParser,null!=o){for(i=0,doc=parser.parseFromString(o,"text/html");i<sqli_msg.length;i++)doc.body.parentElement.innerHTML.includes(sqli_msg[i])&&(document.title="[RoanN]",addIssue(location.href+" - "+e,"SQLi"),location.hash.includes("RNBulk")||alert(alertTxt="\uD835\uDDDA\uD835\uDDFC\uD835\uDDFC\uD835\uDDF1 \uD835\uDDE1\uD835\uDDF2\uD835\uDE04\uD835\uDE00, \uD835\uDC0F\uD835\uDC28\uD835\uDC2C\uD835\uDC2C\uD835\uDC22\uD835\uDC1B\uD835\uDC25\uD835\uDC1E \uD835\uDC12\uD835\uDC10\uD835\uDC0B\uD835\uDC08 \uD835\uDDD9\uD835\uDDFC\uD835\uDE02\uD835\uDDFB\uD835\uDDF1! on "+e+"?"+encodeURI(n).replace("%3Cdiv%20rNnTRbt=roann%3E","{escape}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{escape}").replace("'%22%20rNnTRbt=%22roannATTR%22","{escape}")+" \uD835\uDC04\uD835\uDC2B\uD835\uDC2B\uD835\uDC28\uD835\uDC2B \uD835\uDC0C\uD835\uDC1E\uD835\uDC2C\uD835\uDC2C\uD835\uDC1A\uD835\uDC20\uD835\uDC1E -> "+sqli_msg[i]+" ("+t+")"));var l="";l=n.indexOf("roannATTR")>-1?"[rNnTRbt]":"div[rNnTRbt]",doc.querySelectorAll(l).length>0&&(document.title="[RoanN]",payldClear=(payldClear=n.replace("%3Cdiv%20rNnTRbt=roann%3E","{payload}").replace("%3Cdiv%20rNnTRbt=%22roann%22%3E","{payload}").replace("'%22%20rNnTRbt=%22roannATTR%22","{\uD835\uDDEE\uD835\uDE01\uD835\uDE01\uD835\uDDFF\uD835\uDDF6\uD835\uDDEF\uD835\uDE02\uD835\uDE01\uD835\uDDF2}={payload}")).replace("<div rNnTRbt=roann>","{payload}").replace('rNnTRbt="roannATTR"',"{\uD835\uDDEE\uD835\uDE01\uD835\uDE01\uD835\uDDFF\uD835\uDDF6\uD835\uDDEF\uD835\uDE02\uD835\uDE01\uD835\uDDF2}={payload}"),addIssue(location.href+" - "+e,"XSS"),location.hash.includes("RNBulk")||alert("\uD835\uDDDA\uD835\uDDFC\uD835\uDDFC\uD835\uDDF1 \uD835\uDDE1\uD835\uDDF2\uD835\uDE04\uD835\uDE00, '"+a.toUpperCase()+"' \uD835\uDC1B\uD835\uDC1A\uD835\uDC2C\uD835\uDC1E\uD835\uDC1D \uD835\uDDEB\uD835\uDDE6\uD835\uDDE6 \uD835\uDDD9\uD835\uDDFC\uD835\uDE02\uD835\uDDFB\uD835\uDDF1! on "+e+" , \uD835\uDC03\uD835\uDC1A\uD835\uDC2D\uD835\uDC1A: "+payldClear+" ("+t+")"))}},dataType:"html"}))}function scriptXSS_subtest(e,n,a,t){!(req>=max_req)&&(req+=1,updateBadge(),t?(qry=location.href.split("?")[1],(url=location.href.split("?")[0]).endsWith("/")&&(url=url.slice(0,-1)),url=url.split("/").slice(0,-1).join("/")+"/roannisx"+a+n+"rix?"+qry):(payld=payloadManager(queryString.split("&"),[e,"roannisx"],"roannisx"+a+n+"rix",!1),url=location.href.split("?")[0]+"?"+payld),(xhr=new XMLHttpRequest).onload=function(){parser=new DOMParser,null!=this.responseXML&&[...(doc=parser.parseFromString(this.responseXML.body.parentElement.innerHTML,"text/html")).getElementsByTagName("script")].map(o=>{o.innerText.split("\n").map(o=>{null==(x_match=o.match(n+"(.*)roannisx"+a+a+a+a+n+"rix"))||(document.title="[RoanN]",location.hash.includes("RNBulk")||(alertTxt="\uD835\uDDDA\uD835\uDDFC\uD835\uDDFC\uD835\uDDF1 \uD835\uDDE1\uD835\uDDF2\uD835\uDE04\uD835\uDE00, \uD835\uDC0F\uD835\uDC28\uD835\uDC2C\uD835\uDC2C\uD835\uDC22\uD835\uDC1B\uD835\uDC25\uD835\uDC1E \uD835\uDC17\uD835\uDC12\uD835\uDC12 \uD835\uDC22\uD835\uDC27\uD835\uDC2C\uD835\uDC22\uD835\uDC1D\uD835\uDC1E \uD835\uDC12\uD835\uDC1C\uD835\uDC2B\uD835\uDC22\uD835\uDC29\uD835\uDC2D \uD835\uDC13\uD835\uDC1A\uD835\uDC20 \uD835\uDDD9\uD835\uDDFC\uD835\uDE02\uD835\uDDFB\uD835\uDDF1 on '"+location.href+"' !",t?alertTxt+="(\uD835\uDC0F\uD835\uDC1A\uD835\uDC2D\uD835\uDC21 \uD835\uDC01\uD835\uDC1A\uD835\uDC2C\uD835\uDC1E\uD835\uDC1D)":alertTxt+="("+e+")",alert(alertTxt)))})})},xhr.open("GET",url),xhr.responseType="document",xhr.send())}function scriptXSS(e,n){!(req>=max_req)&&(req+=1,updateBadge(),n?(qry=location.href.split("?")[1],(url=location.href.split("?")[0]).endsWith("/")&&(url=url.slice(0,-1)),url=url.split("/").slice(0,-1).join("/")+"/roannisx?"+qry):(payld=payloadManager(queryString.split("&"),[e,"roannisx"],"roannisx",!1),url=location.href.split("?")[0]+"?"+payld),(xhr=new XMLHttpRequest).onload=function(){parser=new DOMParser,null!=this.responseXML&&[...(doc=parser.parseFromString(this.responseXML.body.parentElement.innerHTML,"text/html")).getElementsByTagName("script")].map(a=>{a.innerText.split("\n").map(a=>{a.split(";").map(a=>{null!=(y_match=a.match(/('|")(.*?)roannisx/))&&(scriptXSS_subtest(e,y_match[1],"",n),scriptXSS_subtest(e,y_match[1],"\\",n))})})})},xhr.open("GET",url),xhr.responseType="document",xhr.send())}function addIssue(e,n){chrome.storage.local.get({history:[]},function(e){var a=e.history;ustr=location.href.length>60?location.href.slice(0,57)+"...":location.href,a.push(['<a target="_blank" href="'+location.href+'">'+ustr+"</a>",n]),chrome.storage.local.set({history:a},function(){console.log("issue added!")})})}function validateCode(e){return!/[^a-zA-Z0-9_]/.test(e)}_=()=>{};var parambox_check=!1;chrome.storage.local.get(["parambox"],function(e){"on"==e.parambox&&(parambox_check=!0)});const queryString=window.location.search.substring(1);var payloads=["'\"><div rNnTRbt=roann>","'\"></script><div rNnTRbt=roann>",'\'" rNnTRbt="roannATTR" x=y'],parambox_dump=[],sqli_msg=["Microsoft OLE DB Provider for ODBC Drivers error","You have an error in your SQL syntax","SQL command not properly ended","Microsoft SQL Native Client error","Query failed: ERROR: syntax error at or near","You have an error in your SQL syntax","MySQL Error: 1064","mysql error with query","SQL syntax error","PostgreSQL query failed: ERROR: parser: parse error","Warning: mysql_","<b>Warning</b>:  mysql_","Warning: mysqli_","<b>Warning</b>:  mysqli_"],tested_param=[],req=0;max_req=0;const unwanted=[".js",".css",".png",".jpg",".jpeg",".gif",".pdf",".exe",".mp3",".mp4",".wav"],unwanted_path=[".php",".php5",".htm",".html",".asp",".aspx",".jsp",".do"];var advancedMode="";chrome.storage.local.get(["advanced"],function(e){advancedMode=e.advanced}),(clear_href=location.href.split("#")[0].split("?")[0]).endsWith("/")&&(clear_href=clear_href.slice(0,-1)),chrome.storage.local.get(["maxreq"],function(e){max_req=parseInt(e.maxreq)}),document.querySelectorAll("[rNnTRbt]").length>0&&alert("\uD835\uDDDA\uD835\uDDFC\uD835\uDDFC\uD835\uDDF1 \uD835\uDDE1\uD835\uDDF2\uD835\uDE04\uD835\uDE00, \uD835\uDC0F\uD835\uDC28\uD835\uDC2C\uD835\uDC2C\uD835\uDC22\uD835\uDC1B\uD835\uDC25\uD835\uDC1E \uD835\uDC12\uD835\uDC2D\uD835\uDC28\uD835\uDC2B\uD835\uDC1E\uD835\uDC1D \uD835\uDDEB\uD835\uDDE6\uD835\uDDE6 \uD835\uDDD9\uD835\uDDFC\uD835\uDE02\uD835\uDDFB\uD835\uDDF1!"),chrome.storage.local.get(["roann"],function(e){if("on"==e.roann){for(i=0;i<unwanted.length;i++)if(location.href.split("#")[0].split("?")[0].toLowerCase().endsWith(unwanted[i]))return;chrome.storage.local.get({blacklist:[]},function(e){for(bi=0;bi<e.blacklist.length;bi++)if(-1!==window.location.hostname.indexOf(e.blacklist[bi]))return;for(p=0;p<payloads.length;p++)testPayload(window.location.href.split("?")[0],"roaNNPaRaM="+payloads[p],"roanNPaRaM",2);if(queryString.length>0){var n=queryString.split("&");for(i=0,url=window.location.href.split("?")[0];i<n.length;i++)if(!tested_param.includes(n[i].split("=")[0])){for(scriptXSS(n[i].split("=")[0],!1),val=n[i].split("="),p=0;p<payloads.length;p++)testPayload(url,payl=payloadManager(n,val,payloads[p],!0),val[0],0);tested_param.push(payl.split("=")[0])}}if(keyword=clear_href.split("/").slice(-1)[0],document.body.parentElement.innerHTML.includes(keyword)&&""!=keyword&&location.hostname!=keyword)for(scriptXSS(null,!0),p=0;p<payloads.length;p++)testPathPayload(clear_href,payloads[p]);chrome.storage.local.get(["onlyget"],function(e){if("off"==e.onlyget){for(r=0,formsCollection=document.forms;r<formsCollection.length;r++)for(i=0,inputs=formsCollection[r].elements;i<inputs.length;i++)if(!tested_param.includes(inputs[i].name)&&""!=inputs[i].name){for(scriptXSS(iname=inputs[i].name,!1),p=0;p<payloads.length;p++)payl=payloadManagerPOST(inputs,iname,payloads[p],!0),null!=formsCollection[r].getAttribute("action")?testPOSTPayload(formsCollection[r].getAttribute("action"),payl,formsCollection[r].method,iname,0):"string"==typeof formsCollection[r].action&&testPOSTPayload(formsCollection[r].action,payl,formsCollection[r].method,iname,0);tested_param.push(iname)}for(inputs=document.getElementsByTagName("input"),heuristic=[],i=0;i<inputs.length;i++)heuristic.push(inputs[i].name+"=FUZZ");for(i=0,url=window.location.href.split("?")[0],heuristic=heuristic.filter(function(e){return"=FUZZ"!=e});i<heuristic.length;i++)if(!tested_param.includes(heuristic[i].split("=")[0])){for(scriptXSS(heuristic[i].split("=")[0],!1),p=0;p<payloads.length;p++)testPayload(url,payl=payloadManager(heuristic,heuristic[i].split("="),payloads[p],!0),heuristic[i].split("=")[0],1);tested_param.push(payl.split("=")[0])}if(document.documentElement.innerHTML.includes("Undefined index")){for(let n of e=document.documentElement.innerHTML.matchAll(/Undefined index: (.*) in/g))if(!tested_param.includes(n[1])){for(scriptXSS(n[1],!1),p=0;p<payloads.length;p++)testPayload(window.location.href.split("?")[0],n[1]+"="+payloads[p],n[1],1);tested_param.push(n[1])}}if("on"==advancedMode){for(let a of v_items=document.documentElement.innerHTML.matchAll(/var ([a-zA-Z0-9_]{1,})\s*=/g))if(!tested_param.includes(a[1])){for(scriptXSS(a[1],!1),p=0;p<payloads.length;p++)validateCode(a[1])&&testPayload(window.location.href.split("?")[0],a[1]+"="+payloads[p],a[1],1);tested_param.push(a[1])}for(let t of e=document.body.parentElement.innerHTML.matchAll(/URLSearchParams\((.*)\)\.get\(([^)]+)\)/g))if(!tested_param.includes(t[2].slice(1,-1)))for(scriptXSS(t[2].slice(1,-1),!1),p=0;p<payloads.length;p++)testPayload(window.location.href.split("?")[0],t[2].slice(1,-1)+"="+payloads[p],t[2].slice(1,-1),1)}}}),chrome.storage.local.get({param_box:[]},function(e){var n=e.param_box;n=n.concat(parambox_dump),n=[...new Set(n)],chrome.storage.local.set({param_box:n},null)})})}});
